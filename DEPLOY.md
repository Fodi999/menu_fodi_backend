# Деплой на Koyeb

## Настройка проекта

1. **Удалён Procfile** - теперь не нужен, так как используется Dockerfile
2. **Добавлен Dockerfile** с многоступенчатой сборкой:
   - Этап сборки: Golang 1.24 Alpine
   - Этап запуска: Distroless base (минимальный размер образа)
3. **Настроен .dockerignore** для оптимизации сборки

## Dockerfile

Проект использует оптимизированный Dockerfile с:
- Многоступенчатой сборкой для минимального размера образа
- Статической сборкой Go приложения
- Distroless образом для безопасности
- Портом 8080

## Деплой на Koyeb

1. Koyeb автоматически найдёт и использует Dockerfile
2. Приложение будет собрано и запущено согласно CMD ["./server"]
3. Порт 8080 будет автоматически проброшен

## Переменные окружения

Убедитесь, что в Koyeb настроены нужные переменные:
- `DATABASE_URL` - строка подключения к базе данных
- `JWT_SECRET` - секрет для JWT токенов
- `PORT` - порт (по умолчанию 8080)

## Команды для локального тестирования

```bash
# Сборка образа
docker build -t menu-backend .

# Запуск контейнера
docker run --rm -p 8080:8080 -e DATABASE_URL="your_db_url" menu-backend
```

## Преимущества нового подхода

- ✅ Автоматическая сборка на Koyeb
- ✅ Минимальный размер образа (~20MB)
- ✅ Безопасность (distroless)
- ✅ Оптимизированная сборка
- ✅ Нет необходимости в предварительной сборке
